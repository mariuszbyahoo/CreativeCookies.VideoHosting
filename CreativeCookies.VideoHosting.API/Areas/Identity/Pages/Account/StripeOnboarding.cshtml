@page
@using CreativeCookies.VideoHosting.Contracts.Enums;
@model CreativeCookies.VideoHosting.API.Areas.Identity.Pages.Account.StripeOnboardingModel

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/5.3.1/css/bootstrap.min.css" rel="stylesheet">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/5.3.1/js/bootstrap.min.js"></script>

<style>
    .container {
        width: 75%;
        margin: auto;
        text-align: center;
    }

    .space {
        margin-top: 7%;
    }
</style>
<script type="text/javascript">
    $(document).ready(function () {
        $("#connectStripeButton").click(function () {
            $('#infoModal').modal('show');

            setTimeout(function () {
                $("#connectStripeForm").submit();
            }, 1000); 
        });
    });
</script>
@{
    var connectBtnTxt = "";
    var connectFormMsg = "";
    var deleteBtnTxt = "";
    var deleteFormTxt = "";
    switch (Model.AccountStatus)
    {
        case StripeConnectAccountStatus.Disconnected:
            connectBtnTxt = "Connect Stripe";
            connectFormMsg = "In order to start setting up payment vendor, please select below:";
            break;
        case StripeConnectAccountStatus.Restricted:
            connectFormMsg = "In order to continue your last attempt on payment setup, please select below:";
            connectBtnTxt = "Continue Onboarding";
            break;
    }
}
<div class="container">
    <h3>Stripe Connect Onboarding</h3>
    @if (Model.AccountStatus == StripeConnectAccountStatus.Restricted || Model.AccountStatus == StripeConnectAccountStatus.Disconnected)
    {
        <p>@connectFormMsg</p>
        <form method="post" asp-page-handler="Connect" id="connectStripeForm">
            <button class="btn btn-outline-primary" type="button" id="connectStripeButton">Connect Stripe</button>
        </form>
    }
    @if (Model.AccountStatus == StripeConnectAccountStatus.Connected)
    {
        <p>Your MyHub is fully connected to the Stripe infrastructure and you're free to create your subscription plan</p>
    }
</div>


<div class="modal fade" id="infoModal" tabindex="-1" role="dialog" aria-labelledby="infoModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="infoModalLabel">Redirecting</h5>
      </div>
      <div class="modal-body">
        <div class="spinner-border spinner-border-lg text-primary" role="status">
            <span class="sr-only"></span>
        </div>
      </div>
    </div>
  </div>
</div>